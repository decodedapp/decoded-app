# 🧪 인증 시스템 테스트 시나리오

## 📋 테스트 체크리스트

### **1. 초기 로딩 상태 테스트**

#### 시나리오 1.1: 첫 방문 (토큰 없음)
- [ ] 페이지 로드 → "Initializing..." 표시
- [ ] 초기화 완료 → "Login" 버튼 표시
- [ ] 로그아웃 버튼이 **절대 표시되지 않음**

#### 시나리오 1.2: 로그인 후 새로고침
- [ ] 페이지 로드 → "Initializing..." 표시
- [ ] 토큰 검증 → 사용자 정보 복원
- [ ] 초기화 완료 → "My Page" + "Logout" 버튼 표시

#### 시나리오 1.3: 만료된 토큰으로 접근
- [ ] 페이지 로드 → "Initializing..." 표시
- [ ] 토큰 만료 감지 → 자동 로그아웃
- [ ] 초기화 완료 → "Login" 버튼 표시

### **2. 로그인 플로우 테스트**

#### 시나리오 2.1: 정상 로그인
- [ ] "Login" 버튼 클릭 → 로그인 모달 열림
- [ ] Google OAuth 완료 → 토큰 저장
- [ ] 사용자 정보 설정 → UI 업데이트
- [ ] "My Page" + "Logout" 버튼 표시

#### 시나리오 2.2: 로그인 실패
- [ ] OAuth 에러 → 에러 메시지 표시
- [ ] 모달 유지 → 재시도 가능
- [ ] 모달 닫기 → "Login" 버튼 유지

### **3. 로그아웃 플로우 테스트**

#### 시나리오 3.1: 정상 로그아웃
- [ ] "Logout" 버튼 클릭 → 즉시 토큰 제거
- [ ] 사용자 정보 초기화 → UI 업데이트
- [ ] "Login" 버튼 표시

#### 시나리오 3.2: 멀티탭 로그아웃 동기화
- [ ] 탭 A에서 로그아웃 → 탭 B도 자동 로그아웃
- [ ] 모든 탭에서 "Login" 버튼 표시

### **4. 멀티탭 동기화 테스트**

#### 시나리오 4.1: 로그인 동기화
- [ ] 탭 A에서 로그인 → 탭 B도 자동 로그인
- [ ] 모든 탭에서 사용자 정보 표시

#### 시나리오 4.2: 토큰 갱신 동기화
- [ ] 한 탭에서 토큰 갱신 → 다른 탭도 동기화
- [ ] 일관된 인증 상태 유지

### **5. 에러 상황 테스트**

#### 시나리오 5.1: 네트워크 에러
- [ ] 프로필 조회 실패 → 에러 상태 표시
- [ ] 재시도 로직 동작 → 최대 3회 시도

#### 시나리오 5.2: 서버 에러 (401, 403, 500)
- [ ] 401 에러 → 자동 로그아웃
- [ ] 403 에러 → 권한 부족 메시지
- [ ] 500 에러 → 재시도 로직

### **6. 상태 지속성 테스트**

#### 시나리오 6.1: 브라우저 재시작
- [ ] 로그인 상태에서 브라우저 종료
- [ ] 재시작 → 로그인 상태 유지
- [ ] sessionStorage 복원 정상 동작

#### 시나리오 6.2: 탭 복원
- [ ] 로그인된 탭 복원 → 즉시 인증 상태 표시
- [ ] 로딩 시간 최소화

## 🎯 **성능 목표**

- **초기화 시간**: < 500ms
- **로그인 완료**: < 2초
- **상태 동기화**: < 100ms
- **UI 반응성**: 즉시 (로딩 상태 표시)

## 🔧 **자동화 테스트 권장사항**

```javascript
// Playwright E2E 테스트 예시
test('로그인 후 새로고침 시 상태 유지', async ({ page }) => {
  // 1. 로그인
  await page.goto('/');
  await page.click('[data-testid="login-button"]');
  // ... OAuth 시뮬레이션
  
  // 2. 새로고침
  await page.reload();
  
  // 3. 상태 검증
  await expect(page.locator('[data-testid="logout-button"]')).toBeVisible();
  await expect(page.locator('[data-testid="login-button"]')).not.toBeVisible();
});
```

## 📊 **모니터링 포인트**

1. **초기화 성공률**: 95% 이상
2. **토큰 갱신 성공률**: 98% 이상
3. **멀티탭 동기화 지연**: < 100ms
4. **에러 복구율**: 90% 이상

---

*Last Updated: 2024-08-22*
*Version: 1.0*